{{ 'section-column-image-text.css' | asset_url | stylesheet_tag }}
{{ 'snippet-image.css' | asset_url | stylesheet_tag }}
{{ 'snippet-image.js' | asset_url | script_tag }}

{% assign background_classes = '' %}
{% case section.settings.background_color %}
    {% when 'green' %}
        {% assign background_classes = ' background-one background-contrast' %}
    {% when 'dark_green' %}
        {% assign background_classes = ' background-two background-contrast' %}
    {% else %}
        {% assign background_classes = '' %}
{% endcase %}

<div class="section-column-image-text section{{ background_classes }}" aria-labelledby="section-column-image-text-{{ section.id }}">
    <div class="container">

        {% if section.settings.heading != blank or section.settings.content != blank %}
            <div class="section-column-image-text__precontent">
                {% if section.settings.heading != blank %}
                    <h2 id="section-column-image-text-{{ section.id }}" class="section-column-image-text__title">
                        {{ section.settings.heading }}
                    </h2>
                {% endif %}

                {% if section.settings.content != blank %}
                    <div class="section-column-image-text__richtext lead">
                        {{ section.settings.content }}
                    </div>
                {% endif %}
            </div>
        {% endif %}

        {% if section.blocks.size > 0 %}
            <div class="section-column-image-text__wrapper">
                <div class="section-column-image-text__grid">
                    {% for block in section.blocks %}
                        {% case block.type %}
                            {% when 'column' %}
                                <div class="section-column-image-text__column" {{ block.shopify_attributes }}>

                                    {% if block.settings.image %}
                                        <div class="section-column-image-text__media">
                                            {% render 'image',
                                                    image: block.settings.image,
                                                    aspect_ratio: '3-2',
                                                    decoration_type: 'none',
                                                    alt: block.settings.image_alt,
                                                    loading: 'lazy',
                                                    sizes: '(min-width: 1280px) 400px, (min-width: 768px) 33vw, 100vw'
                                            %}
                                        </div>
                                    {% endif %}

                                    <div class="section-column-image-text__content">
                                        {% if block.settings.heading != blank %}
                                            <h3 class="section-column-image-text__column-title">
                                                {{ block.settings.heading }}
                                            </h3>
                                        {% endif %}

                                        {% if block.settings.content != blank %}
                                            <div class="section-column-image-text__column-richtext">
                                                {{ block.settings.content }}
                                            </div>
                                        {% endif %}
                                    </div>

                                </div>
                        {% endcase %}
                    {% endfor %}
                </div>
            </div>
        {% endif %}

    </div>
</div>

{% schema %}
{
  "name": "Column Image Text",
  "tag": "section",
  "class": "section-column-image-text-wrapper",
  "settings": [
    {
      "type": "header",
      "content": "Pre-Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Überschrift",
      "default": "Lorem Ipsum Dolor Sit"
    },
    {
      "type": "richtext",
      "id": "content",
      "label": "Inhalt",
      "default": "<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>"
    },
    {
      "type": "header",
      "content": "Design"
    },
    {
      "type": "select",
      "id": "background_color",
      "label": "Hintergrundfarbe",
      "options": [
        {
          "value": "default",
          "label": "Standard"
        },
        {
          "value": "green",
          "label": "Grün"
        },
        {
          "value": "dark_green",
          "label": "Dunkel Grün"
        }
      ],
      "default": "default"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "Spalte",
      "settings": [
        {
          "type": "header",
          "content": "Bild"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Bild"
        },
        {
          "type": "text",
          "id": "image_alt",
          "label": "Bildbeschreibung (Alt-Text)",
          "info": "Beschreibe das Bild für Barrierefreiheit"
        },
        {
          "type": "header",
          "content": "Inhalt"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Überschrift",
          "default": "Lorem Ipsum"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Inhalt",
          "default": "<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Column Image Text",
      "category": "Bild + Inhalt",
      "blocks": [
        {
          "type": "column"
        },
        {
          "type": "column"
        },
        {
          "type": "column"
        }
      ]
    }
  ]
}
{% endschema %}