{{ 'section-hero-small.css' | asset_url | stylesheet_tag }}

{% comment %} Preload critical fonts first {% endcomment %}
<link rel="preload" href="{{ 'font-camera-obscura.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="{{ 'font-arlen--regular.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin="anonymous">

{% comment %} Preload hero images for better performance {% endcomment %}
{% if section.settings.image_desktop != blank %}
    <link rel="preload" as="image" href="{{ section.settings.image_desktop | image_url: width: 1440 }}" media="(min-width: 768px)" fetchpriority="high">
{% endif %}
{% if section.settings.image_mobile != blank %}
    <link rel="preload" as="image" href="{{ section.settings.image_mobile | image_url: width: 768 }}" media="(max-width: 767px)" fetchpriority="high">
{% endif %}

{% comment %} Critical inline CSS to prevent rendering delays {% endcomment %}
<style>
    /* Critical hero styles - inline to prevent blocking */
    .hero-section {
        position: relative;
        contain: layout style;
        padding-top: var(--component-spacing-y, 64px);
        padding-bottom: var(--component-spacing-y, 64px);
    }

    .hero-title {
        font-family: 'Camera Obscura', serif;
        font-size: clamp(32px, 5vw, 64px);
        line-height: 1.1;
        color: var(--color-primary, #3F593F);
        margin: 0 0 24px;
        font-display: swap;
        contain: layout style;
        transform: translateZ(0);
        backface-visibility: hidden;
        will-change: auto;
        text-rendering: optimizeSpeed;
    }

    .hero-background {
        position: relative;
        contain: layout style paint;
    }

    .hero-background-image {
        width: 100%;
        height: auto;
        display: block;
        will-change: auto;
        content-visibility: auto;
    }

    .hero-content {
        contain: layout style;
        position: relative;
        z-index: 2;
    }

    .background-contrast {
        background-color: var(--color-primary, #3F593F);
    }

    .background-contrast .hero-title {
        color: var(--color-white, #FFFFFF) !important;
    }

    /* Container and layout */
    .container {
        padding-left: 16px;
        padding-right: 16px;
        margin: 0 auto;
        max-width: 1920px;
    }

    @media (min-width: 768px) {
        .container {
            padding-left: 24px;
            padding-right: 24px;
        }
        .hero-section {
            padding-top: 80px;
            padding-bottom: 80px;
        }
    }

    @media (min-width: 1280px) {
        .container {
            padding-left: 64px;
            padding-right: 64px;
        }
        .hero-section {
            padding-top: 120px;
            padding-bottom: 120px;
        }
    }
</style>

{% comment %} Load section CSS asynchronously after critical render {% endcomment %}
<link rel="preload" href="{{ 'section-hero-small.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>{{ 'section-hero-small.css' | asset_url | stylesheet_tag }}</noscript>

<section class="background-contrast">
    <div class="hero-section container component-padding-y">
        <div class="hero-background">
            {% if section.settings.image_desktop != blank or section.settings.image_mobile != blank %}
                <picture>
                    {% if section.settings.image_desktop != blank %}
                        <source media="(min-width: 768px)" srcset="{{ section.settings.image_desktop | image_url: width: 1440 }} 1440w, {{ section.settings.image_desktop | image_url: width: 1200 }} 1200w, {{ section.settings.image_desktop | image_url: width: 1000 }} 1000w" sizes="100vw">
                    {% endif %}
                    {% if section.settings.image_mobile != blank %}
                        <img src="{{ section.settings.image_mobile | image_url: width: 768 }}"
                             srcset="{{ section.settings.image_mobile | image_url: width: 768 }} 768w, {{ section.settings.image_mobile | image_url: width: 600 }} 600w, {{ section.settings.image_mobile | image_url: width: 400 }} 400w"
                             sizes="100vw"
                             alt="{{ section.settings.image_alt }}"
                             class="hero-background-image"
                             fetchpriority="high"
                             decoding="sync"
                             loading="eager">
                    {% elsif section.settings.image_desktop != blank %}
                        <img src="{{ section.settings.image_desktop | image_url: width: 768 }}"
                             srcset="{{ section.settings.image_desktop | image_url: width: 1440 }} 1440w, {{ section.settings.image_desktop | image_url: width: 1200 }} 1200w, {{ section.settings.image_desktop | image_url: width: 1000 }} 1000w"
                             sizes="100vw"
                             alt="{{ section.settings.image_alt }}"
                             class="hero-background-image"
                             fetchpriority="high"
                             decoding="sync"
                             loading="eager">
                    {% endif %}
                </picture>
            {% endif %}
        </div>

        <div class="hero-decor--desktop" aria-hidden="true" preserveAspectRatio="none">
            {{ 'decor-hero-small-background-desktop.svg' | inline_asset_content }}
        </div>

        <div class="hero-decor--mobile" aria-hidden="true" >
            {{ 'decor-hero-background-mobile.svg' | inline_asset_content }}
        </div>

        <div class="hero-content">
            {% if section.settings.heading_h1 != blank %}
                <h1 class="hero-title" style="font-display: swap;">{{ section.settings.heading_h1 }}</h1>
            {% endif %}

            {% if section.settings.heading_h2 != blank %}
                <h2 class="hero-subtitle">{{ section.settings.heading_h2 }}</h2>
            {% endif %}

            {% if section.settings.button_text != blank %}
                <a href="{{ section.settings.button_link }}" class="button-primary">
                    {{ section.settings.button_text }}
                </a>
            {% endif %}
        </div>

    </div>

    {% if section.settings.show_breadcrumbs %}
        {% render 'hero-small-breadcrumbs', breadcrumb_text: section.settings.breadcrumb_current %}
    {% endif %}
</section>

{% schema %}
{
  "name": "Hero",
  "tag": "section",
  "class": "section-hero",
  "settings": [
    {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "Hintergrundbild Desktop"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Hintergrundbild Mobile"
    },
    {
      "type": "text",
      "id": "image_alt",
      "label": "Bild Alt-Text"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Breadcrumbs anzeigen",
      "default": true
    },
    {
      "type": "text",
      "id": "breadcrumb_current",
      "label": "Aktueller Breadcrumb Text (optional)",
      "info": "Leer lassen für automatische Erkennung"
    },
    {
      "type": "text",
      "id": "heading_h1",
      "label": "Hauptüberschrift (H1)",
      "default": "Lorem Ipsum"
    },
    {
      "type": "text",
      "id": "heading_h2",
      "label": "Unterüberschrift (H2)",
      "default": "Entdecken Sie unsere Produkte"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Jetzt entdecken"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "select",
      "id": "button_type",
      "label": "Button Type",
      "options": [
        {
          "value": "primary",
          "label": "Primary"
        },
        {
          "value": "secondary",
          "label": "Secondary"
        },
        {
          "value": "tertiary",
          "label": "Tertiary"
        }
      ],
      "default": "primary"
    }
  ],
  "presets": [
    {
      "name": "Hero Klein",
      "category": "Hero"
    }
  ]
}
{% endschema %}