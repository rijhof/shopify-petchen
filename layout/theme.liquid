<!DOCTYPE html>
<html lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="">

  <link rel="canonical" href="{{ canonical_url }}">
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>

  {%- if settings.favicon != blank -%}
    <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
  {%- endif -%}

  {%- unless settings.type_header_font.system? and settings.type_body_font.system? -%}
    <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
  {%- endunless -%}

  <!-- Critical CSS inline -->
  <style>
    /* Critical CSS - nur das Nötigste für Above-the-Fold Content */
    :root {
      --baseline: 8px;
      --color-primary: #3F593F;
      --color-secondary: #F4F2E4;
      --color-background: #DFECDF;
      --color-text: #2F4027;
      --color-white: #FFFFFF;
      --font-family-default: 'Arlen', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      --font-family-display: 'Camera Obscura', 'Arlen', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      --container-padding-mobile: 16px;
      --container-padding-desktop: 64px;
      --transition-duration: 0.25s;
    }

    @font-face {
      font-family: 'Arlen';
      src: url('{{ 'font-arlen--regular.woff2' | asset_url }}') format('woff2');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    @font-face {
      font-family: 'Camera Obscura';
      src: url('{{ 'font-camera-obscura.woff2' | asset_url }}') format('woff2');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      background-color: var(--color-secondary);
      color: var(--color-text);
      font-family: var(--font-family-default);
      margin: 0;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      padding: 0 var(--container-padding-mobile);
      margin: 0 auto;
      max-width: 1920px;
    }

    @media (min-width: 1280px) {
      .container {
        padding: 0 var(--container-padding-desktop);
      }
    }

    /* Header Critical Styles */
    header {
      background-color: var(--color-secondary);
      position: relative;
    }

    /* Prevent Layout Shift */
    .main {
      min-height: 50vh;
    }
  </style>

  <!-- Fonts mit höherer Priorität laden -->
  <link rel="preload" href="{{ 'font-arlen--regular.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin="anonymous" fetchpriority="high">
  <link rel="preload" href="{{ 'font-camera-obscura.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin="anonymous" fetchpriority="high">

  <!-- CSS asynchron laden -->
  <link rel="preload" href="{{ 'theme.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="{{ 'section-header.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">

  <!-- Fallback für Browser ohne JavaScript -->
  <noscript>
    <link rel="stylesheet" href="{{ 'theme.css' | asset_url }}">
    <link rel="stylesheet" href="{{ 'section-header.css' | asset_url }}">
  </noscript>

  <!-- Resource Hints für kritische Domains -->
  <link rel="dns-prefetch" href="https://cdn.shopify.com">
  <link rel="dns-prefetch" href="https://fonts.shopifycdn.com">

  <title>
    {{ page_title }}
    {%- if current_tags %} &ndash; tagged "{{ current_tags | join: ', ' }}"{% endif -%}
    {%- if current_page != 1 %} &ndash; Page {{ current_page }}{% endif -%}
    {%- unless page_title contains shop.name %} &ndash; {{ shop.name }}{% endunless -%}
  </title>

  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}">
  {% endif %}

  {% render 'meta-tags' %}

  {{ content_for_header }}

  <!-- JavaScript für CSS-Loading -->
  <script>
    // Polyfill für rel=preload
    !function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},!o.support()){var t,d=n.document.getElementsByTagName("link");for(t=0;t<d.length;t++){var e=d[t];"preload"!==e.rel||"style"!==e.getAttribute("as")||e.getAttribute("data-loadcss")||(e.setAttribute("data-loadcss",!0),o.bindMediaToggle(e))}}}(window);
  </script>

</head>
<body>
{% section 'header' %}
<main id="main" class="main" role="main" tabindex="-1">
  {{ content_for_layout }}
</main>
{% section 'footer' %}

{% render 'cart-notification' %}

<!-- Scripts mit defer laden -->
<script src="{{ 'cart-notification.js' | asset_url }}" defer></script>
<script src="{{ 'snippet-product-card.js' | asset_url }}" defer></script>
<script src="{{ 'js-section-header.js' | asset_url }}" defer></script>
<script src="{{ 'index.js' | asset_url }}" defer></script>
</body>
</html>